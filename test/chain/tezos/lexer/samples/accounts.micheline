{  
   "script":[  
      {  
         "prim":"parameter",
         "args":[  
            {  
               "prim":"or",
               "args":[  
                  {  
                     "prim":"key_hash",
                     "annots":[  
                        "%Initialize"
                     ]
                  },
                  {  
                     "prim":"pair",
                     "args":[  
                        {  
                           "prim":"key",
                           "annots":[  
                              "%from"
                           ]
                        },
                        {  
                           "prim":"pair",
                           "args":[  
                              {  
                                 "prim":"mutez",
                                 "annots":[  
                                    "%withdraw_amount"
                                 ]
                              },
                              {  
                                 "prim":"signature",
                                 "annots":[  
                                    "%sig"
                                 ]
                              }
                           ]
                        }
                     ],
                     "annots":[  
                        "%Withdraw"
                     ]
                  }
               ]
            }
         ]
      },
      {  
         "prim":"storage",
         "args":[  
            {  
               "prim":"map",
               "args":[  
                  {  
                     "prim":"key_hash"
                  },
                  {  
                     "prim":"mutez"
                  }
               ],
               "annots":[  
                  ":stored_balance"
               ]
            }
         ]
      },
      {  
         "prim":"code",
         "args":[  
            [  
               {  
                  "prim":"DUP"
               },
               {  
                  "prim":"CAR"
               },
               {  
                  "prim":"IF_LEFT",
                  "args":[  
                     [  
                        {  
                           "prim":"DUP"
                        },
                        [  
                           {  
                              "prim":"DIP",
                              "args":[  
                                 [  
                                    {  
                                       "prim":"DIP",
                                       "args":[  
                                          [  
                                             {  
                                                "prim":"CDR",
                                                "annots":[  
                                                   "%stored_balance"
                                                ]
                                             },
                                             {  
                                                "prim":"DUP"
                                             }
                                          ]
                                       ]
                                    }
                                 ]
                              ]
                           }
                        ],
                        {  
                           "prim":"DIP",
                           "args":[  
                              [  
                                 {  
                                    "prim":"SWAP"
                                 }
                              ]
                           ]
                        },
                        {  
                           "prim":"GET",
                           "annots":[  
                              "@opt_prev_balance"
                           ]
                        },
                        [  
                           {  
                              "prim":"IF_NONE",
                              "args":[  
                                 [  
                                    {  
                                       "prim":"DIP",
                                       "args":[  
                                          [  
                                             {  
                                                "prim":"AMOUNT"
                                             },
                                             {  
                                                "prim":"SOME"
                                             }
                                          ]
                                       ]
                                    },
                                    {  
                                       "prim":"UPDATE"
                                    },
                                    {  
                                       "prim":"NIL",
                                       "args":[  
                                          {  
                                             "prim":"operation"
                                          }
                                       ]
                                    },
                                    {  
                                       "prim":"PAIR"
                                    }
                                 ],
                                 [  
                                    {  
                                       "prim":"RENAME",
                                       "annots":[  
                                          "@previous_balance"
                                       ]
                                    },
                                    {  
                                       "prim":"AMOUNT"
                                    },
                                    {  
                                       "prim":"ADD"
                                    },
                                    {  
                                       "prim":"SOME"
                                    },
                                    {  
                                       "prim":"SWAP"
                                    },
                                    {  
                                       "prim":"UPDATE"
                                    },
                                    {  
                                       "prim":"NIL",
                                       "args":[  
                                          {  
                                             "prim":"operation"
                                          }
                                       ]
                                    },
                                    {  
                                       "prim":"PAIR"
                                    }
                                 ]
                              ]
                           }
                        ]
                     ],
                     [  
                        {  
                           "prim":"DUP"
                        },
                        {  
                           "prim":"DUP"
                        },
                        {  
                           "prim":"DUP"
                        },
                        {  
                           "prim":"DUP"
                        },
                        {  
                           "prim":"CAR",
                           "annots":[  
                              "%from"
                           ]
                        },
                        [  
                           {  
                              "prim":"DIP",
                              "args":[  
                                 [  
                                    {  
                                       "prim":"DIP",
                                       "args":[  
                                          [  
                                             [  
                                                {  
                                                   "prim":"CDR"
                                                },
                                                {  
                                                   "prim":"CAR",
                                                   "annots":[  
                                                      "%withdraw_amount"
                                                   ]
                                                }
                                             ],
                                             {  
                                                "prim":"PACK"
                                             },
                                             {  
                                                "prim":"BLAKE2B",
                                                "annots":[  
                                                   "@signed_amount"
                                                ]
                                             }
                                          ]
                                       ]
                                    }
                                 ]
                              ]
                           }
                        ],
                        {  
                           "prim":"DIP",
                           "args":[  
                              [  
                                 [  
                                    {  
                                       "prim":"CDR"
                                    },
                                    {  
                                       "prim":"CDR",
                                       "annots":[  
                                          "%sig"
                                       ]
                                    }
                                 ]
                              ]
                           ]
                        },
                        {  
                           "prim":"CHECK_SIGNATURE"
                        },
                        {  
                           "prim":"IF",
                           "args":[  
                              [  

                              ],
                              [  
                                 {  
                                    "prim":"PUSH",
                                    "args":[  
                                       {  
                                          "prim":"string"
                                       },
                                       {  
                                          "string":"Bad signature"
                                       }
                                    ]
                                 },
                                 {  
                                    "prim":"FAILWITH"
                                 }
                              ]
                           ]
                        },
                        [  
                           {  
                              "prim":"DIP",
                              "args":[  
                                 [  
                                    {  
                                       "prim":"DIP",
                                       "args":[  
                                          [  
                                             {  
                                                "prim":"CDR",
                                                "annots":[  
                                                   "%stored_balance"
                                                ]
                                             },
                                             {  
                                                "prim":"DUP"
                                             }
                                          ]
                                       ]
                                    }
                                 ]
                              ]
                           }
                        ],
                        {  
                           "prim":"CAR",
                           "annots":[  
                              "%from"
                           ]
                        },
                        {  
                           "prim":"HASH_KEY",
                           "annots":[  
                              "@from_hash"
                           ]
                        },
                        {  
                           "prim":"DUP"
                        },
                        {  
                           "prim":"DIP",
                           "args":[  
                              [  
                                 {  
                                    "prim":"DIP",
                                    "args":[  
                                       [  
                                          {  
                                             "prim":"SWAP"
                                          }
                                       ]
                                    ]
                                 },
                                 {  
                                    "prim":"SWAP"
                                 }
                              ]
                           ]
                        },
                        {  
                           "prim":"GET"
                        },
                        {  
                           "prim":"IF_NONE",
                           "args":[  
                              [  
                                 {  
                                    "prim":"PUSH",
                                    "args":[  
                                       {  
                                          "prim":"string"
                                       },
                                       {  
                                          "string":"Account does not exist"
                                       }
                                    ]
                                 },
                                 {  
                                    "prim":"PAIR"
                                 },
                                 {  
                                    "prim":"FAILWITH"
                                 }
                              ],
                              [  
                                 {  
                                    "prim":"RENAME",
                                    "annots":[  
                                       "@previous_balance"
                                    ]
                                 },
                                 {  
                                    "prim":"DIP",
                                    "args":[  
                                       [  
                                          {  
                                             "prim":"DROP"
                                          }
                                       ]
                                    ]
                                 },
                                 {  
                                    "prim":"DUP"
                                 },
                                 [  
                                    {  
                                       "prim":"DIP",
                                       "args":[  
                                          [  
                                             {  
                                                "prim":"DIP",
                                                "args":[  
                                                   [  
                                                      {  
                                                         "prim":"DUP"
                                                      },
                                                      [  
                                                         {  
                                                            "prim":"CDR"
                                                         },
                                                         {  
                                                            "prim":"CAR",
                                                            "annots":[  
                                                               "%withdraw_amount"
                                                            ]
                                                         }
                                                      ],
                                                      {  
                                                         "prim":"DUP"
                                                      }
                                                   ]
                                                ]
                                             }
                                          ]
                                       ]
                                    }
                                 ],
                                 {  
                                    "prim":"DIP",
                                    "args":[  
                                       [  
                                          [  
                                             {  
                                                "prim":"COMPARE"
                                             },
                                             {  
                                                "prim":"LT",
                                                "annots":[  
                                                   "@not_enough"
                                                ]
                                             }
                                          ]
                                       ]
                                    ]
                                 },
                                 {  
                                    "prim":"SWAP"
                                 },
                                 {  
                                    "prim":"IF",
                                    "args":[  
                                       [  
                                          {  
                                             "prim":"PUSH",
                                             "args":[  
                                                {  
                                                   "prim":"string"
                                                },
                                                {  
                                                   "string":"Not enough funds"
                                                }
                                             ]
                                          },
                                          {  
                                             "prim":"FAILWITH"
                                          }
                                       ],
                                       [  
                                          {  
                                             "prim":"SUB",
                                             "annots":[  
                                                "@new_balance"
                                             ]
                                          },
                                          {  
                                             "prim":"DIP",
                                             "args":[  
                                                [  
                                                   {  
                                                      "prim":"DUP"
                                                   },
                                                   {  
                                                      "prim":"DIP",
                                                      "args":[  
                                                         [  
                                                            {  
                                                               "prim":"SWAP"
                                                            }
                                                         ]
                                                      ]
                                                   }
                                                ]
                                             ]
                                          },
                                          {  
                                             "prim":"DUP"
                                          },
                                          {  
                                             "prim":"PUSH",
                                             "args":[  
                                                {  
                                                   "prim":"mutez"
                                                },
                                                {  
                                                   "int":"0"
                                                }
                                             ],
                                             "annots":[  
                                                "@zero"
                                             ]
                                          },
                                          [  
                                             {  
                                                "prim":"COMPARE"
                                             },
                                             {  
                                                "prim":"EQ",
                                                "annots":[  
                                                   "@null_balance"
                                                ]
                                             }
                                          ],
                                          {  
                                             "prim":"IF",
                                             "args":[  
                                                [  
                                                   {  
                                                      "prim":"DROP"
                                                   },
                                                   {  
                                                      "prim":"NONE",
                                                      "args":[  
                                                         {  
                                                            "prim":"mutez"
                                                         }
                                                      ],
                                                      "annots":[  
                                                         "@new_balance"
                                                      ]
                                                   }
                                                ],
                                                [  
                                                   {  
                                                      "prim":"SOME",
                                                      "annots":[  
                                                         "@new_balance"
                                                      ]
                                                   }
                                                ]
                                             ]
                                          },
                                          {  
                                             "prim":"SWAP"
                                          },
                                          {  
                                             "prim":"CAR",
                                             "annots":[  
                                                "%from"
                                             ]
                                          },
                                          {  
                                             "prim":"HASH_KEY",
                                             "annots":[  
                                                "@from_hash"
                                             ]
                                          },
                                          {  
                                             "prim":"UPDATE"
                                          },
                                          {  
                                             "prim":"SWAP"
                                          },
                                          {  
                                             "prim":"DUP"
                                          },
                                          [  
                                             {  
                                                "prim":"CDR"
                                             },
                                             {  
                                                "prim":"CAR",
                                                "annots":[  
                                                   "%withdraw_amount"
                                                ]
                                             }
                                          ],
                                          {  
                                             "prim":"DIP",
                                             "args":[  
                                                [  
                                                   {  
                                                      "prim":"CAR",
                                                      "annots":[  
                                                         "%from"
                                                      ]
                                                   },
                                                   {  
                                                      "prim":"HASH_KEY",
                                                      "annots":[  
                                                         "@from_hash"
                                                      ]
                                                   },
                                                   {  
                                                      "prim":"IMPLICIT_ACCOUNT",
                                                      "annots":[  
                                                         "@from_account"
                                                      ]
                                                   }
                                                ]
                                             ]
                                          },
                                          {  
                                             "prim":"UNIT"
                                          },
                                          {  
                                             "prim":"TRANSFER_TOKENS",
                                             "annots":[  
                                                "@widthdraw_transfer_op"
                                             ]
                                          },
                                          {  
                                             "prim":"NIL",
                                             "args":[  
                                                {  
                                                   "prim":"operation"
                                                }
                                             ]
                                          },
                                          {  
                                             "prim":"SWAP"
                                          },
                                          {  
                                             "prim":"CONS"
                                          },
                                          {  
                                             "prim":"PAIR"
                                          }
                                       ]
                                    ]
                                 }
                              ]
                           ]
                        }
                     ]
                  ]
               }
            ]
         ]
      }
   ],
   "storage":{  
      "string":"before"
   },
   "input":{  
      "string":"after"
   },
   "amount":"50000"
}