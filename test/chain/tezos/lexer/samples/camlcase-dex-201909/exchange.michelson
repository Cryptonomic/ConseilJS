parameter (or (or (pair nat
                        (pair nat
                              timestamp))
                  (pair (pair nat
                              mutez)
                        (pair nat
                              timestamp)))
              (or (pair nat
                        timestamp)
                  (or (pair nat
                            (pair mutez
                                  timestamp))
                      nat)));
storage (pair (big_map address
                       nat)
              (pair (pair (contract (or (pair address
                                              (contract (or (pair address
                                                                  (pair address
                                                                        nat))
                                                            address)))
                                        nat))
                          (contract (or (pair address
                                              (pair address
                                                    nat))
                                        address)))
                    (pair nat
                          (map address
                               (or (or (pair nat
                                             (pair nat
                                                   timestamp))
                                       (pair (pair nat
                                                   mutez)
                                             (pair nat
                                                   timestamp)))
                                   (or (pair nat
                                             timestamp)
                                       (pair nat
                                             (pair mutez
                                                   timestamp))))))));
code { DUP;
       CAR;
       DIP { CDR };
       IF_LEFT { IF_LEFT { DUP;
                           CDR;
                           CDR;
                           NOW;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "addLiquidity: Expected the deadline to be greater than now.";
                                FAILWITH };
                           DUP;
                           CDR;
                           CAR;
                           PUSH nat 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "addLiquidity: Expected maxTokens to be greater than 0.";
                                FAILWITH };
                           AMOUNT;
                           PUSH mutez 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "addLiquidity: Expected the amount sent to the contract to be greater than 0.";
                                FAILWITH };
                           SWAP;
                           DUP;
                           CDR;
                           CDR;
                           CAR;
                           DIP { PUSH nat 0 };
                           COMPARE;
                           GT;
                           IF { SWAP;
                                SENDER;
                                DIP { DIP { DUP };
                                      SWAP;
                                      CDR;
                                      CAR;
                                      CDR };
                                PAIR;
                                DIP { LEFT (pair (pair nat mutez) (pair nat timestamp));
                                      LEFT (or (pair nat timestamp) (pair nat (pair mutez timestamp)));
                                      SOME;
                                      DIP { DUP;
                                            CDR;
                                            CDR;
                                            CDR };
                                      SENDER;
                                      UPDATE;
                                      DIP { DUP;
                                            CDR;
                                            CDR };
                                      DIP { DUP;
                                            DIP { CAR };
                                            CDR };
                                      DIP { DROP };
                                      SWAP;
                                      PAIR;
                                      DIP { DUP;
                                            DIP { CAR };
                                            CDR };
                                      DIP { DUP;
                                            DIP { CAR };
                                            CDR };
                                      DIP { DROP };
                                      SWAP;
                                      PAIR;
                                      SWAP;
                                      PAIR };
                                LEFT nat;
                                DIP { DUP;
                                      CDR;
                                      CAR;
                                      CAR;
                                      AMOUNT };
                                TRANSFER_TOKENS;
                                NIL operation;
                                SWAP;
                                CONS;
                                PAIR }
                              { PUSH mutez 1000000;
                                AMOUNT;
                                COMPARE;
                                GE;
                                IF {  }
                                   { PUSH string "addLiquidity: amount is less than 1 XTZ.";
                                     FAILWITH };
                                DUP;
                                CAR;
                                BALANCE;
                                DIP { PUSH mutez 1 };
                                EDIV;
                                IF_NONE { PUSH nat 0 }
                                        { CAR };
                                SOME;
                                SENDER;
                                UPDATE;
                                DIP { DUP;
                                      DIP { CDR };
                                      CAR };
                                DIP { DROP };
                                PAIR;
                                DUP;
                                CDR;
                                CDR;
                                BALANCE;
                                DIP { PUSH mutez 1 };
                                EDIV;
                                IF_NONE { PUSH nat 0 }
                                        { CAR };
                                DIP { DUP;
                                      DIP { CDR };
                                      CAR };
                                DIP { DROP };
                                PAIR;
                                DIP { DUP;
                                      DIP { CAR };
                                      CDR };
                                DIP { DUP;
                                      DIP { CAR };
                                      CDR };
                                DIP { DROP };
                                SWAP;
                                PAIR;
                                SWAP;
                                PAIR;
                                SENDER;
                                DIP { SELF;
                                      ADDRESS;
                                      DIP { DIP { DUP };
                                            SWAP;
                                            CDR;
                                            CAR };
                                      PAIR };
                                PAIR;
                                DIP { DIP { DROP } };
                                LEFT address;
                                DIP { DUP;
                                      CDR;
                                      CAR;
                                      CDR;
                                      PUSH mutez 0 };
                                TRANSFER_TOKENS;
                                NIL operation;
                                SWAP;
                                CONS;
                                PAIR } }
                         { DUP;
                           CAR;
                           CAR;
                           PUSH nat 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "removeLiquidity: expected burnAmount to be greater than zero.";
                                FAILWITH };
                           DUP;
                           CDR;
                           CDR;
                           NOW;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "removeLiquidity: expected deadline to be greater than the current time.";
                                FAILWITH };
                           DUP;
                           CAR;
                           CDR;
                           PUSH mutez 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "removeLiquidity: expected minMutez to be greater than zero.";
                                FAILWITH };
                           DUP;
                           CDR;
                           CAR;
                           PUSH nat 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "removeLiquidity: expected minTokens to be greater than zero.";
                                FAILWITH };
                           RIGHT (pair nat (pair nat timestamp));
                           LEFT (or (pair nat timestamp) (pair nat (pair mutez timestamp)));
                           SOME;
                           DIP { DUP;
                                 CDR;
                                 CDR;
                                 CDR };
                           SENDER;
                           UPDATE;
                           DIP { DUP;
                                 CDR;
                                 CDR };
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DROP };
                           SWAP;
                           PAIR;
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DROP };
                           SWAP;
                           PAIR;
                           SWAP;
                           PAIR;
                           SENDER;
                           DIP { DUP;
                                 CDR;
                                 CAR;
                                 CDR };
                           PAIR;
                           LEFT nat;
                           DIP { DUP;
                                 CDR;
                                 CAR;
                                 CAR;
                                 AMOUNT };
                           TRANSFER_TOKENS;
                           NIL operation;
                           SWAP;
                           CONS;
                           PAIR } }
               { IF_LEFT { DUP;
                           CDR;
                           DIP { NOW };
                           COMPARE;
                           GE;
                           IF {  }
                              { PUSH string "tezToToken: the deadline is less than the current time.";
                                FAILWITH };
                           AMOUNT;
                           PUSH mutez 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "tezToToken: tezosSold is zero.";
                                FAILWITH };
                           DUP;
                           CAR;
                           PUSH nat 0;
                           COMPARE;
                           LT;
                           IF {  }
                              { PUSH string "tezToToken: minTokens is zero.";
                                FAILWITH };
                           LEFT (pair nat (pair mutez timestamp));
                           RIGHT (or (pair nat (pair nat timestamp)) (pair (pair nat mutez) (pair nat timestamp)));
                           SOME;
                           DIP { DUP;
                                 CDR;
                                 CDR;
                                 CDR };
                           SENDER;
                           UPDATE;
                           DIP { DUP;
                                 CDR;
                                 CDR };
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DROP };
                           SWAP;
                           PAIR;
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DUP;
                                 DIP { CAR };
                                 CDR };
                           DIP { DROP };
                           SWAP;
                           PAIR;
                           SWAP;
                           PAIR;
                           SELF;
                           ADDRESS;
                           DIP { DUP;
                                 CDR;
                                 CAR;
                                 CDR };
                           PAIR;
                           LEFT nat;
                           DIP { DUP;
                                 CDR;
                                 CAR;
                                 CAR;
                                 AMOUNT };
                           TRANSFER_TOKENS;
                           NIL operation;
                           SWAP;
                           CONS;
                           PAIR }
                         { IF_LEFT { DUP;
                                     CDR;
                                     CDR;
                                     DIP { NOW };
                                     COMPARE;
                                     GE;
                                     IF {  }
                                        { PUSH string "tokenToTez: the deadline is less than the current time.";
                                          FAILWITH };
                                     DUP;
                                     CAR;
                                     PUSH nat 0;
                                     COMPARE;
                                     LT;
                                     IF {  }
                                        { PUSH string "tokenToTez: tokensSold is zero.";
                                          FAILWITH };
                                     DUP;
                                     CDR;
                                     CAR;
                                     PUSH mutez 0;
                                     COMPARE;
                                     LT;
                                     IF {  }
                                        { PUSH string "tokenToTez: minMutez is zero.";
                                          FAILWITH };
                                     RIGHT (pair nat timestamp);
                                     RIGHT (or (pair nat (pair nat timestamp)) (pair (pair nat mutez) (pair nat timestamp)));
                                     SOME;
                                     DIP { DUP;
                                           CDR;
                                           CDR;
                                           CDR };
                                     SENDER;
                                     UPDATE;
                                     DIP { DUP;
                                           CDR;
                                           CDR };
                                     DIP { DUP;
                                           DIP { CAR };
                                           CDR };
                                     DIP { DROP };
                                     SWAP;
                                     PAIR;
                                     DIP { DUP;
                                           DIP { CAR };
                                           CDR };
                                     DIP { DUP;
                                           DIP { CAR };
                                           CDR };
                                     DIP { DROP };
                                     SWAP;
                                     PAIR;
                                     SWAP;
                                     PAIR;
                                     SENDER;
                                     DIP { DUP;
                                           CDR;
                                           CAR;
                                           CDR };
                                     PAIR;
                                     LEFT nat;
                                     DIP { DUP;
                                           CDR;
                                           CAR;
                                           CAR;
                                           AMOUNT };
                                     TRANSFER_TOKENS;
                                     NIL operation;
                                     SWAP;
                                     CONS;
                                     PAIR }
                                   { SWAP;
                                     DUP;
                                     CDR;
                                     CAR;
                                     CAR;
                                     ADDRESS;
                                     SENDER;
                                     COMPARE;
                                     EQ;
                                     IF {  }
                                        { PUSH string "continuation: this method only allows calls from the broker contract.";
                                          FAILWITH };
                                     DUP;
                                     CDR;
                                     CDR;
                                     CDR;
                                     SOURCE;
                                     GET;
                                     IF_NONE { PUSH string "continuation: the continuation storage could not be found for the transaction source.";
                                               FAILWITH }
                                             {  };
                                     DIP { DUP;
                                           CDR;
                                           CDR;
                                           CDR;
                                           NONE (or (or (pair nat (pair nat timestamp)) (pair (pair nat mutez) (pair nat timestamp))) (or (pair nat timestamp) (pair nat (pair mutez timestamp))));
                                           SOURCE;
                                           UPDATE;
                                           DIP { DUP;
                                                 CDR;
                                                 CDR };
                                           DIP { DUP;
                                                 DIP { CAR };
                                                 CDR };
                                           DIP { DROP };
                                           SWAP;
                                           PAIR;
                                           DIP { DUP;
                                                 DIP { CAR };
                                                 CDR };
                                           DIP { DUP;
                                                 DIP { CAR };
                                                 CDR };
                                           DIP { DROP };
                                           SWAP;
                                           PAIR;
                                           SWAP;
                                           PAIR };
                                     IF_LEFT { IF_LEFT { SWAP;
                                                         DIP { SWAP };
                                                         SWAP;
                                                         DUP;
                                                         AMOUNT;
                                                         DIP { PUSH mutez 1 };
                                                         EDIV;
                                                         IF_NONE { PUSH nat 0 }
                                                                 { CAR };
                                                         MUL;
                                                         DIP { AMOUNT;
                                                               DIP { PUSH mutez 1 };
                                                               EDIV;
                                                               IF_NONE { PUSH nat 0 }
                                                                       { CAR };
                                                               BALANCE;
                                                               DIP { PUSH mutez 1 };
                                                               EDIV;
                                                               IF_NONE { PUSH nat 0 }
                                                                       { CAR };
                                                               SUB;
                                                               ISNAT;
                                                               IF_NONE { PUSH string "getMutezReserve failed, the natural value was unexpectedly less than zero.";
                                                                         FAILWITH }
                                                                       {  } };
                                                         EDIV;
                                                         IF_NONE { PUSH string "addLiquidityContinuation: divide by zero error, tezosReserve was zero in the formula (amount * tokenReserve / tezosReserve + 1).";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         PUSH nat 1;
                                                         ADD;
                                                         DIP { SWAP };
                                                         SWAP;
                                                         DUP;
                                                         CDR;
                                                         CDR;
                                                         CAR;
                                                         AMOUNT;
                                                         DIP { PUSH mutez 1 };
                                                         EDIV;
                                                         IF_NONE { PUSH nat 0 }
                                                                 { CAR };
                                                         MUL;
                                                         DIP { SWAP };
                                                         EDIV;
                                                         IF_NONE { PUSH string "addLiquidityContinuation: divide by zero error, tokenReserve was zero in the formula (amount * totalSupply / tokenReserve).";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         DIP { DIP { DIP { DUP;
                                                                           CDR;
                                                                           CAR };
                                                                     DUP;
                                                                     DIP { COMPARE;
                                                                           LE;
                                                                           IF {  }
                                                                              { PUSH string "addLiquidityContinuation: Expected maxTokens >= tokenAmount";
                                                                                FAILWITH } } } };
                                                         DIP { DIP { SWAP };
                                                               SWAP;
                                                               CAR };
                                                         DUP;
                                                         DIP { COMPARE;
                                                               LE;
                                                               IF {  }
                                                                  { PUSH string "addLiquidityContinuation: Expected liquidityMinted >= minLiquidity";
                                                                    FAILWITH } };
                                                         SWAP;
                                                         SOURCE;
                                                         DIP { DUP;
                                                               CAR };
                                                         GET;
                                                         IF_NONE { PUSH nat 0 }
                                                                 {  };
                                                         DIP { SWAP;
                                                               DUP };
                                                         ADD;
                                                         SOME;
                                                         DIP { SWAP;
                                                               DUP;
                                                               CAR };
                                                         SOURCE;
                                                         UPDATE;
                                                         DIP { DUP;
                                                               DIP { CDR };
                                                               CAR };
                                                         DIP { DROP };
                                                         PAIR;
                                                         SWAP;
                                                         DIP { DUP;
                                                               CDR;
                                                               CDR;
                                                               CAR };
                                                         ADD;
                                                         DIP { DUP;
                                                               CDR;
                                                               CDR };
                                                         DIP { DUP;
                                                               DIP { CDR };
                                                               CAR };
                                                         DIP { DROP };
                                                         PAIR;
                                                         DIP { DUP;
                                                               DIP { CAR };
                                                               CDR };
                                                         DIP { DUP;
                                                               DIP { CAR };
                                                               CDR };
                                                         DIP { DROP };
                                                         SWAP;
                                                         PAIR;
                                                         SWAP;
                                                         PAIR;
                                                         SOURCE;
                                                         DIP { SELF;
                                                               ADDRESS;
                                                               DIP { DIP { DUP };
                                                                     SWAP };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DIP { DROP } };
                                                         LEFT address;
                                                         DIP { DUP;
                                                               CDR;
                                                               CAR;
                                                               CDR;
                                                               PUSH mutez 0 };
                                                         TRANSFER_TOKENS;
                                                         NIL operation;
                                                         SWAP;
                                                         CONS;
                                                         PAIR }
                                                       { DUP;
                                                         CAR;
                                                         CAR;
                                                         BALANCE;
                                                         MUL;
                                                         DIP { SWAP;
                                                               DUP;
                                                               CDR;
                                                               CDR;
                                                               CAR };
                                                         EDIV;
                                                         IF_NONE { PUSH string "removeLiquidityContinuation: division by zero";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         DIP { SWAP;
                                                               DUP;
                                                               CAR;
                                                               CDR };
                                                         DUP;
                                                         DIP { COMPARE;
                                                               GE;
                                                               IF {  }
                                                                  { PUSH string "removeLiquidityContinuation: the mutez amount to be withdrawn is lower than the minMutez that you have set.";
                                                                    FAILWITH };
                                                               SWAP };
                                                         DIP { SWAP };
                                                         SWAP;
                                                         DUP;
                                                         CAR;
                                                         CAR;
                                                         DIP { DIP { DIP { SWAP };
                                                                     SWAP };
                                                               SWAP };
                                                         MUL;
                                                         DIP { DIP { SWAP };
                                                               SWAP;
                                                               DUP;
                                                               CDR;
                                                               CDR;
                                                               CAR };
                                                         EDIV;
                                                         IF_NONE { PUSH string "removeLiquidityContinuation: division by zero";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         SWAP;
                                                         SOURCE;
                                                         DIP { DUP;
                                                               CAR };
                                                         GET;
                                                         IF_NONE { PUSH nat 0 }
                                                                 {  };
                                                         DIP { DIP { SWAP };
                                                               SWAP;
                                                               DUP;
                                                               CAR;
                                                               CAR };
                                                         SUB;
                                                         ISNAT;
                                                         IF_NONE { PUSH string "removeLiquidityContinuation: burnAmount is more than balance.";
                                                                   FAILWITH }
                                                                 {  };
                                                         SOME;
                                                         DIP { SWAP;
                                                               DUP;
                                                               CAR };
                                                         SOURCE;
                                                         UPDATE;
                                                         DIP { DUP;
                                                               DIP { CDR };
                                                               CAR };
                                                         DIP { DROP };
                                                         PAIR;
                                                         DUP;
                                                         CDR;
                                                         CDR;
                                                         CAR;
                                                         DIP { SWAP;
                                                               CAR;
                                                               CAR };
                                                         SUB;
                                                         ISNAT;
                                                         IF_NONE { PUSH string "removeLiquidityContinuation: burnAmount is more than balance.";
                                                                   FAILWITH }
                                                                 {  };
                                                         DIP { DUP;
                                                               CDR;
                                                               CDR };
                                                         DIP { DUP;
                                                               DIP { CDR };
                                                               CAR };
                                                         DIP { DROP };
                                                         PAIR;
                                                         DIP { DUP;
                                                               DIP { CAR };
                                                               CDR };
                                                         DIP { DUP;
                                                               DIP { CAR };
                                                               CDR };
                                                         DIP { DROP };
                                                         SWAP;
                                                         PAIR;
                                                         SWAP;
                                                         PAIR;
                                                         DIP { SWAP };
                                                         SWAP;
                                                         DIP { SOURCE;
                                                               CONTRACT unit;
                                                               IF_NONE { PUSH string "removeLiquidityContinuation: the source contract does not match the expected type (contract Unit).";
                                                                         FAILWITH }
                                                                       {  } };
                                                         UNIT;
                                                         TRANSFER_TOKENS;
                                                         NIL operation;
                                                         SWAP;
                                                         CONS;
                                                         DIP { SWAP };
                                                         SWAP;
                                                         SELF;
                                                         ADDRESS;
                                                         DIP { SOURCE;
                                                               DIP { DUP };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DROP };
                                                         LEFT address;
                                                         DIP { SWAP;
                                                               DUP;
                                                               CDR;
                                                               CAR;
                                                               CDR;
                                                               PUSH mutez 0 };
                                                         TRANSFER_TOKENS;
                                                         DIP { SWAP };
                                                         CONS;
                                                         PAIR } }
                                             { IF_LEFT { SWAP;
                                                         DIP { SWAP };
                                                         SWAP;
                                                         AMOUNT;
                                                         DIP { PUSH mutez 1 };
                                                         EDIV;
                                                         IF_NONE { PUSH nat 0 }
                                                                 { CAR };
                                                         DIP { AMOUNT;
                                                               BALANCE;
                                                               SUB;
                                                               DIP { PUSH mutez 1 };
                                                               EDIV;
                                                               IF_NONE { PUSH nat 0 }
                                                                       { CAR };
                                                               DIP { DUP };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DROP };
                                                         DUP;
                                                         CDR;
                                                         CAR;
                                                         PUSH nat 0;
                                                         COMPARE;
                                                         LT;
                                                         IF {  }
                                                            { PUSH string "inputReserve must be greater than zero";
                                                              FAILWITH };
                                                         DUP;
                                                         CDR;
                                                         CDR;
                                                         PUSH nat 0;
                                                         COMPARE;
                                                         LT;
                                                         IF {  }
                                                            { PUSH string "outputReserve must be greater than zero";
                                                              FAILWITH };
                                                         DUP;
                                                         CAR;
                                                         PUSH nat 997;
                                                         MUL;
                                                         DUP;
                                                         DIP { DIP { DUP;
                                                                     CDR;
                                                                     CDR };
                                                               MUL };
                                                         SWAP;
                                                         DIP { DIP { CDR;
                                                                     CAR;
                                                                     PUSH nat 1000;
                                                                     MUL };
                                                               ADD };
                                                         EDIV;
                                                         IF_NONE { PUSH string "getInputPrice division by zero";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         DIP { SWAP };
                                                         DIP { CAR };
                                                         DUP;
                                                         DIP { COMPARE;
                                                               GE;
                                                               IF {  }
                                                                  { PUSH string "tezToTokenContinuation: tokens bought is less than the minTokens amount you set.";
                                                                    FAILWITH } };
                                                         SELF;
                                                         ADDRESS;
                                                         DIP { SOURCE;
                                                               DIP { DUP };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DROP };
                                                         LEFT address;
                                                         DIP { DUP;
                                                               CDR;
                                                               CAR;
                                                               CDR;
                                                               PUSH mutez 0 };
                                                         TRANSFER_TOKENS;
                                                         NIL operation;
                                                         SWAP;
                                                         CONS;
                                                         PAIR }
                                                       { DIP { SWAP };
                                                         SWAP;
                                                         SWAP;
                                                         DUP;
                                                         CAR;
                                                         DIP { DIP { DUP };
                                                               SWAP;
                                                               DIP { BALANCE;
                                                                     DIP { PUSH mutez 1 };
                                                                     EDIV;
                                                                     IF_NONE { PUSH nat 0 }
                                                                             { CAR } };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DIP { DROP } };
                                                         DUP;
                                                         CDR;
                                                         CAR;
                                                         PUSH nat 0;
                                                         COMPARE;
                                                         LT;
                                                         IF {  }
                                                            { PUSH string "inputReserve must be greater than zero";
                                                              FAILWITH };
                                                         DUP;
                                                         CDR;
                                                         CDR;
                                                         PUSH nat 0;
                                                         COMPARE;
                                                         LT;
                                                         IF {  }
                                                            { PUSH string "outputReserve must be greater than zero";
                                                              FAILWITH };
                                                         DUP;
                                                         CAR;
                                                         PUSH nat 997;
                                                         MUL;
                                                         DUP;
                                                         DIP { DIP { DUP;
                                                                     CDR;
                                                                     CDR };
                                                               MUL };
                                                         SWAP;
                                                         DIP { DIP { CDR;
                                                                     CAR;
                                                                     PUSH nat 1000;
                                                                     MUL };
                                                               ADD };
                                                         EDIV;
                                                         IF_NONE { PUSH string "getInputPrice division by zero";
                                                                   FAILWITH }
                                                                 { CAR };
                                                         PUSH mutez 1;
                                                         MUL;
                                                         DUP;
                                                         DIP { DROP };
                                                         SOURCE;
                                                         CONTRACT unit;
                                                         IF_NONE { PUSH string "tokenToTezContinuation: the source does not match the expected contract type (contract unit).";
                                                                   FAILWITH }
                                                                 {  };
                                                         SWAP;
                                                         UNIT;
                                                         TRANSFER_TOKENS;
                                                         NIL operation;
                                                         SWAP;
                                                         CONS;
                                                         SWAP;
                                                         DIP { SWAP };
                                                         SOURCE;
                                                         DIP { SELF;
                                                               ADDRESS;
                                                               DIP { DUP;
                                                                     SWAP;
                                                                     CAR };
                                                               PAIR };
                                                         PAIR;
                                                         DIP { DROP };
                                                         LEFT address;
                                                         DIP { DUP;
                                                               CDR;
                                                               CAR;
                                                               CDR;
                                                               PUSH mutez 0 };
                                                         TRANSFER_TOKENS;
                                                         DIP { SWAP };
                                                         CONS;
                                                         PAIR } } } } } };